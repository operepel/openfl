# Compose an FL plan in JSON/YAML.
# * Task name
# * Task description
# * The folder path to the locally runnable code.
# * The software dependency.
# * FL parameters: fed_id, opt_treatment.

# * Added by the coordinator later: agg_id, agg_url, poll_interval.


# We may have several plans for one dataset, to search the best model architecture for exammple.

task            : mnist
version         : 1
description     : Train a model to recognize hand-written digits from 0 to 9.
status          : active
# The federation/plan ID is linked to certain software version, code (including model architecture), initialization, dataset, aggregation configuration, etc.
federation      : fl_mnist_conv2fc2
dataset         : mnist_batch
software_version: '1'

model:
  
  name     : mnist_cnn_keras
  optimizer: SGD
  # The code includes pre-processing.
  code:
    # Basically the name under models/
    path     : mnist_cnn_keras
    version  : 1  

aggregator:
  id           : agg_mnist
  # FIXME: should be assigned automatically
  addr           : "spr-gpu02"
  # addr           : "127.0.0.1"
  port           : 8848

  collaborators  : 1
  initial_weights: federations/weights/mnist_cnn_keras_init.pbuf
  latest_weights : federations/weights/mnist_cnn_keras_latest.pbuf


collaborator:
  # dataset:
  #   # The path in the docker image.
  #   name             : mnist_batch
  #   path             : /opt/datasets/mnist/
  opt_vars_treatment : RESET
  sync_per_iterations: 100 
