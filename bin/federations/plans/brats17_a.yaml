# Compose an FL plan in JSON/YAML.
# * Task name
# * Task description
# * The folder path to the locally runnable code.
# * The software dependency.
# * FL parameters: fed_id, opt_treatment.

# * Added by the coordinator later: agg_id, agg_url, poll_interval.


# We may have several plans for one dataset, to search the best model architecture for exammple.

task            : brats
version         : '1'
description     : Train a model to perform semantic segmentation on brain fMRI images.
status          : active
federation      : fl_brats_2dunet

model:
  name     : mnist_cnn_keras
  optimizer: SGD
  # The code includes pre-processing.
  code_path: models.mnist_cnn_keras
  version : 1
  params:
    # The dataset path will be copy from the dataset section.
    batch_size: 256
    dataset_path: ../datasets/mnist_batch/mnist_batch.npz

model:
  # TODO: hyper-parameters
  # The code includes pre-processing.
  name     : brats_2dunet_tensorflow
  # We may specify the optimizer and other hyper-parameters to the code.
  optimizer: SGD
  code:
    path: brats_2dunet_tensorflow
    kwargs:
      batch_size: 64
      shuffle: True

aggregator:
  id             : agg_brats
  addr           : "spr-gpu01.jf.intel.com"
  port           : 8848

  # FIXME: a list of names who are permitted to join the federation. 
  collaborators  : 2
  initial_weights: TensorFlow2DUNet_init.pbuf
  latest_weights : TensorFlow2DUNet_latest.pbuf
  best_weights   : TensorFlow2DUNet_best.pbuf

collaborator:
  opt_vars_treatment : RESET
  sync_per_iterations: 100 

tls:
  disable             : False
  disable_client_auth : False
  cert_folder         : test
